# –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ 1: –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –≤–∏–Ω–∞ —Å –ø–æ–º–æ—â—å—é –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è

## –°—Å—ã–ª–∫–∏ –Ω–∞ —Ä–µ—Å—É—Ä—Å—ã

- üìì Jupyter Notebook: [GitHub](https://github.com/morozovvaa/mo6pract1/blob/main/%D0%9C%D0%BE%D1%80%D0%BE%D0%B7%D0%BE%D0%B2%D0%B0_%D0%BF%D1%80%D0%B0%D0%BA%D1%82_1.ipynb)  
- üìä –î–∞—Ç–∞—Å–µ—Ç: [Wine Quality Dataset –Ω–∞ Kaggle](https://www.kaggle.com/datasets/yasserh/wine-quality-dataset)  
- ‚òÅÔ∏è Google Colab: [Colab-—Å–µ—Å—Å–∏—è](https://colab.research.google.com/drive/10eN7-q0CUsLe_n6GGkjQjcdujm1vMDSo?usp=sharing)  

---

## –í–≤–µ–¥–µ–Ω–∏–µ

–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –º–æ–¥–µ–ª–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –≤–∏–Ω–∞ (–æ—Ç 3 –¥–æ 9 –±–∞–ª–ª–æ–≤) –ø–æ –µ–≥–æ —Ö–∏–º–∏—á–µ—Å–∫–∏–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º. –í –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–æ–ª–Ω—ã–π ML-–ø–∞–π–ø–ª–∞–π–Ω: –æ—Ç –∞–Ω–∞–ª–∏–∑–∞ –∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –¥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–∏ –≤ –≤–∏–¥–µ REST API –∏ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.

---

## –û–ø–∏—Å–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–ò—Å—Ç–æ—á–Ω–∏–∫: [Wine Quality Dataset (Kaggle)](https://www.kaggle.com/datasets/yasserh/wine-quality-dataset)

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞          | –û–ø–∏—Å–∞–Ω–∏–µ                     |
|-------------------------|------------------------------|
| fixed acidity           | —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–∏—Å–ª–æ—Ç–Ω–æ—Å—Ç—å    |
| volatile acidity        | –ª–µ—Ç—É—á–∞—è –∫–∏—Å–ª–æ—Ç–Ω–æ—Å—Ç—å          |
| citric acid             | –ª–∏–º–æ–Ω–Ω–∞—è –∫–∏—Å–ª–æ—Ç–∞             |
| residual sugar          | –æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π —Å–∞—Ö–∞—Ä             |
| chlorides               | —Ö–ª–æ—Ä–∏–¥—ã                      |
| free sulfur dioxide     | —Å–≤–æ–±–æ–¥–Ω—ã–π –¥–∏–æ–∫—Å–∏–¥ —Å–µ—Ä—ã       |
| total sulfur dioxide    | –æ–±—â–∏–π –¥–∏–æ–∫—Å–∏–¥ —Å–µ—Ä—ã           |
| density                 | –ø–ª–æ—Ç–Ω–æ—Å—Ç—å                    |
| pH                      | —É—Ä–æ–≤–µ–Ω—å pH                   |
| sulphates               | —Å—É–ª—å—Ñ–∞—Ç—ã                     |
| alcohol                 | —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –∞–ª–∫–æ–≥–æ–ª—è (%)      |
| quality (—Ü–µ–ª–µ–≤–∞—è)       | –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ (–æ—Ç 3 –¥–æ 9)  |

- –ö—Ä–∞—Å–Ω–æ–µ –≤–∏–Ω–æ: 1599 –æ–±—Ä–∞–∑—Ü–æ–≤  
- –ë–µ–ª–æ–µ –≤–∏–Ω–æ: 4898 –æ–±—Ä–∞–∑—Ü–æ–≤  
- –û–±—â–∏–π —Ä–∞–∑–º–µ—Ä: 6497 –æ–±—Ä–∞–∑—Ü–æ–≤

---


## –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
```
!wget -O winequality.zip "https://drive.google.com/uc?id=1YHDSDHi-Av312W3GHnMclmLJ2dNKQ7k1 " --no-check-certificate
!unzip -q winequality.zip -d wine_data
```
## –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
```
df_red = pd.read_csv("wine_data/winequality-red.csv", sep=';')
df_white = pd.read_csv("wine_data/winequality-white.csv", sep=';')

df_red['type'] = 'red'
df_white['type'] = 'white'

df = pd.concat([df_red, df_white], ignore_index=True)
```
## –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞
```
X_trainval, X_test, y_trainval, y_test = train_test_split(X, y, test_size=0.15, stratify=y, random_state=42)
X_train, X_val, y_train, y_val = train_test_split(X_trainval, y_trainval, test_size=0.1765, stratify=y_trainval, random_state=42)
```
## –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞
```
sns.countplot(data=df, x='quality', hue='type')
plt.title('Quality Distribution by Wine Type')
plt.show()
```
## –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞
```
corr = df.drop(columns=['type']).corr()
plt.figure(figsize=(12,8))
sns.heatmap(corr, annot=True, cmap='coolwarm')
plt.title('Feature Correlation Heatmap')
plt.show()
```
## –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
## DummyClassifier
```
dummy = DummyClassifier(strategy="most_frequent")
dummy.fit(X_train, y_train)
dummy_pred = dummy.predict(X_val)
print(classification_report(y_val, dummy_pred))
```
## –õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è
```
lr = LogisticRegression(max_iter=1000)
lr.fit(X_train, y_train)
lr_pred = lr.predict(X_val)
print(classification_report(y_val, lr_pred))
```
## –°–ª—É—á–∞–π–Ω—ã–π –ª–µ—Å
```
rf = RandomForestClassifier(n_estimators=100, random_state=42)
rf.fit(X_train, y_train)
rf_pred = rf.predict(X_val)
print(classification_report(y_val, rf_pred))
```
## XGBoost
```
xgb = XGBClassifier(use_label_encoder=False, eval_metric='mlogloss')
xgb.fit(X_train, y_train_enc)
xgb_pred = xgb.predict(X_val)
print(classification_report(y_val_enc, xgb_pred))
```
## –ù–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å
```
model = Sequential()
model.add(Dense(100, input_dim=x_train.shape[1], activation='relu'))
model.add(Dense(10, activation='relu'))
model.add(Dense(7, activation='softmax'))

model.compile(optimizer=Adam(learning_rate=0.001), metrics=['accuracy'], loss='categorical_crossentropy')
history = model.fit(x_train, y_train, validation_data=(x_val, y_val), epochs=500, batch_size=32)
```
## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
–õ—É—á—à–∞—è –º–æ–¥–µ–ª—å:
Random Forest
## –§–∏–Ω–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
–î–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏ –±—ã–ª –≤—ã–±—Ä–∞–Ω Random Forest —Å –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
```
rf = RandomForestClassifier(
    n_estimators=500,
    max_depth=25,
    min_samples_leaf=2,
    class_weight='balanced',
    random_state=42
)
```
## –ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ –Ω–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
```
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)
X_val_scaled = scaler.transform(X_val)
X_test_scaled = scaler.transform(X_test)

rf.fit(X_train_scaled, y_train)
```
## –û—Ü–µ–Ω–∫–∞ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ:
```
rf_pred = rf.predict(X_test_scaled)
print("Accuracy:", accuracy_score(y_test, rf_pred))
print("Macro F1-score:", f1_score(y_test, rf_pred, average='macro'))
```
## –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
```
joblib.dump(rf, "final_wine_model.pkl")
joblib.dump(scaler, "scaler.pkl")
```



# REST API
–°–µ—Ä–≤–∏—Å –Ω–∞–ø–∏—Å–∞–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Flask , –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–¥–∏–Ω —ç–Ω–¥–ø–æ–∏–Ω—Ç /api/predict , –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ –≤–∏–Ω–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON.
## –í—ã–±—Ä–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
- –ë—ã–ª–∞ –æ–±—É—á–µ–Ω–∞ –∏ –≤—ã–±—Ä–∞–Ω–∞ –º–æ–¥–µ–ª—å Random Forest Classifier , –ø–æ–∫–∞–∑–∞–≤—à–∞—è –Ω–∞–∏–ª—É—á—à–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ
- –ú–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ —Ñ–∞–π–ª final_wine_model.pkl.
- –ü–æ–º–∏–º–æ —Å–∞–º–æ–≥–æ –∫–ª–∞—Å—Å–∞ (–∫–∞—á–µ—Å—Ç–≤–æ), –º–æ–¥–µ–ª—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –∫ –∫–∞–∂–¥–æ–º—É –∫–ª–∞—Å—Å—É (–æ—Ç 3 –¥–æ 9). –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ, –Ω–æ –∏ –ø–æ–Ω—è—Ç—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–µ—Ä–≤–∏—Å–∞
- Python
- Flask ‚Äî –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è REST API
- joblib ‚Äî –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –∏ —Å–∫–∞–ª–µ—Ä–∞
- JSON ‚Äî —Ñ–æ—Ä–º–∞—Ç –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö
- POST -–∑–∞–ø—Ä–æ—Å—ã ‚Äî –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –æ –≤–∏–Ω–µ

## –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã
POST /api/predict  
–û–ø–∏—Å–∞–Ω–∏–µ: –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–∏–Ω–∞ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞.

## –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (JSON):
```
{
  "fixed acidity": 7.4,
  "volatile acidity": 0.7,
  "citric acid": 0,
  "residual sugar": 1.9,
  "chlorides": 0.076,
  "free sulfur dioxide": 11,
  "total sulfur dioxide": 34,
  "density": 0.9978,
  "pH": 3.51,
  "sulphates": 0.56,
  "alcohol": 9.4,
  "type": 1
}
```
## –û—Ç–≤–µ—Ç (JSON):
```
{
  "prediction": 5,
  "probabilities": [0.0018, 0.1447, 0.7587, 0.0900, 0.0048, 0.0, 0.0]
}
```
![image](https://github.com/user-attachments/assets/9e7e8ba1-4878-4a96-ac06-1c191f1be3a4)
## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API
## –ó–∞–ø—Ä–æ—Å —á–µ—Ä–µ–∑ curl :
```
curl -X POST -H "Content-Type: application/json" \
-d '{"fixed acidity": 7.4, "volatile acidity": 0.7, "citric acid": 0, "residual sugar": 1.9, "chlorides": 0.076, "free sulfur dioxide": 11, "total sulfur dioxide": 34, "density": 0.9978, "pH": 3.51, "sulphates": 0.56, "alcohol": 9.4, "type": 1}' \
http://127.0.0.1:5000/predict
```
## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
wine-quality-api/
‚îú‚îÄ‚îÄ app.py                  # Flask-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ final_wine_model.pkl    # –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
‚îú‚îÄ‚îÄ scaler.pkl              # –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π —Å–∫–∞–ª–µ—Ä
‚îú‚îÄ‚îÄ requirements.txt        # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ README.md               # –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
```
## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫
## –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```
pip install -r requirements.txt
```
## –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä
```
python app.py
```
–°–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:5000/

# –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

–í –¥–∞–Ω–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –≤–µ–±-–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ , –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –≤–≤–æ–¥–∏—Ç—å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –≤–∏–Ω–∞ –∏ –ø–æ–ª—É—á–∞—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –µ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–±—É—á–µ–Ω–Ω–æ–π –º–∞—à–∏–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–∞–∫–∂–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –∫ –∫–∞–∂–¥–æ–º—É –∫–ª–∞—Å—Å—É –∫–∞—á–µ—Å—Ç–≤–∞.
## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
wine_api/
‚îú‚îÄ‚îÄ app.py                # Flask-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îî‚îÄ‚îÄ index.html        # HTML-—à–∞–±–ª–æ–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
‚îú‚îÄ‚îÄ venv/                 # –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ final_wine_model.pkl  # –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–∞—è –º–æ–¥–µ–ª—å Random Forest
‚îú‚îÄ‚îÄ scaler.pkl            # –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π —Å–∫–∞–ª–µ—Ä
‚îî‚îÄ‚îÄ requirements.txt       # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
```
## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
Backend (Flask)
## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
## –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –∏ —Å–∫–µ–π–ª–µ—Ä–∞:
–ú–æ–¥–µ–ª—å (final_wine_model.pkl) –∏ —Å–∫–µ–π–ª–µ—Ä (scaler.pkl) –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
–ï—Å–ª–∏ —Ñ–∞–π–ª—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç, –æ–Ω–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∏–≤–∞—é—Ç—Å—è –∏–∑ Google Drive.
```
if not os.path.exists(MODEL_PATH):
    file_id = "1UK4FKJYK4E5_dng6IUmrE0XHFlgtBtd7"
    url = f"https://drive.google.com/uc?id= {file_id}"
    gdown.download(url, MODEL_PATH, quiet=False)
```
## –≠–Ω–¥–ø–æ–∏–Ω—Ç /api/predict:
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç POST-–∑–∞–ø—Ä–æ—Å —Å –¥–∞–Ω–Ω—ã–º–∏ –æ –≤–∏–Ω–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON.
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é scaler.
- –í—ã–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é –º–æ–¥–µ–ª–∏.
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON
```
{
    "prediction": 5,
    "confidence": 0.7587,
    "probabilities": {
        "3": 0.0018,
        "4": 0.1447,
        "5": 0.7587,
        "6": 0.0900,
        "7": 0.0048,
        "8": 0.0,
        "9": 0.0
    }
}
```
```
@app.route('/api/predict', methods=['POST'])
def predict_api():
    try:
        data = request.get_json()
        features = [
            data['fixed_acidity'],
            data['volatile_acidity'],
            data['citric_acid'],
            data['residual_sugar'],
            data['chlorides'],
            data['free_sulfur_dioxide'],
            data['total_sulfur_dioxide'],
            data['density'],
            data['pH'],
            data['sulphates'],
            data['alcohol'],
            data['wine_type']
        ]
        X = np.array([features])
        X_scaled = scaler.transform(X)
        prediction = model.predict(X_scaled)[0]
        probabilities = model.predict_proba(X_scaled)[0]
        proba_dict = {str(i): float(prob) for i, prob in enumerate(probabilities)}
        return jsonify({
            'prediction': int(prediction),
            'confidence': float(np.max(probabilities)),
            'probabilities': proba_dict
        })
    except Exception as e:
        return jsonify({'error': str(e)}), 500
```
## –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (/):
–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç HTML-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö –æ –≤–∏–Ω–µ.
```
@app.route('/')
def index():
    return render_template('index.html')
```
## Frontend (HTML + JavaScript)
## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
## –§–æ—Ä–º–∞ –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö:
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–≤–µ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –≤—Å–µ—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –≤–∏–Ω–∞.
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Bootstrap –¥–ª—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏ —Ñ–æ—Ä–º—ã.
```
<form id="prediction-form">
    <div class="feature-input">
        <label for="wine_type">–¢–∏–ø –≤–∏–Ω–∞</label>
        <select id="wine_type" required>
            <option value="0">–ë–µ–ª–æ–µ</option>
            <option value="1">–ö—Ä–∞—Å–Ω–æ–µ</option>
        </select>
    </div>
    <div class="feature-input">
        <label for="fixed_acidity">–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–∏—Å–ª–æ—Ç–Ω–æ—Å—Ç—å</label>
        <input type="number" id="fixed_acidity" step="0.1" value="7.0" required>
    </div>
    <!-- –î—Ä—É–≥–∏–µ –ø–æ–ª—è -->
    <button type="submit">–ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ</button>
</form>
```
## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã:
–ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–æ—Ä–º—ã –¥–∞–Ω–Ω—ã–µ —Å–µ—Ä–∏–∞–ª–∏–∑—É—é—Ç—Å—è –≤ JSON –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç /api/predict.  
–†–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è JavaScript'–æ–º –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ.
```
document.getElementById('prediction-form').addEventListener('submit', async function(e) {
    e.preventDefault();
    const formData = {
        fixed_acidity: parseFloat(document.getElementById('fixed_acidity').value),
        volatile_acidity: parseFloat(document.getElementById('volatile_acidity').value),
        // –î—Ä—É–≥–∏–µ –ø–æ–ª—è
        wine_type: parseInt(document.getElementById('wine_type').value)
    };
    const response = await fetch('/api/predict', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(formData)
    });
    const result = await response.json();
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
});
```
## –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Chart.js –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π.  
–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ Chart.js –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏.
```
new Chart(ctx, {
    type: 'bar',
    data: {
        labels: ['3', '4', '5', '6', '7', '8', '9'],
        datasets: [{
            label: '–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ (%)',
            data: probabilities.map(p => p * 100),
            backgroundColor: 'rgba(75, 192, 192, 0.6)',
            borderColor: 'rgba(75, 192, 192, 1)',
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            y: {
                beginAtZero: true,
                max: 100
            }
        }
    }
});
```
## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
## –ì–ª–∞–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
## –í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö –æ –≤–∏–Ω–µ:
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–≤–µ—Å—Ç–∏ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –≤–∏–Ω–∞ —á–µ—Ä–µ–∑ —É–¥–æ–±–Ω—É—é —Ñ–æ—Ä–º—É.
## –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞:
–ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã –¥–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –∏ –º–æ–¥–µ–ª—å –≤—ã–¥–∞—ë—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ.
## –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:
–ù–∞ —ç–∫—Ä–∞–Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è:  
- –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –≤–∏–Ω–∞.
- –£—Ä–æ–≤–µ–Ω—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏.
- –ì—Ä–∞—Ñ–∏–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –ø–æ –≤—Å–µ–º –∫–ª–∞—Å—Å–∞–º.
## –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –∏ –≤–∏–¥–µ—Ç—å, –∫–∞–∫ –º–µ–Ω—è–µ—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏ –∑–∞–ø—É—Å–∫
## –®–∞–≥–∏ –¥–ª—è –∑–∞–ø—É—Å–∫–∞:
## –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```
python -m venv venv
venv\Scripts\activate     # Windows
source venv/bin/activate  # macOS/Linux
```
## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```
pip install -r requirements.txt
```
## –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```
python app.py
```
## –î–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é:
–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:5000/

![image](https://github.com/user-attachments/assets/e71604d5-fc97-404f-826c-fdb90bba04d0)





![image](https://github.com/user-attachments/assets/a4f1db31-f6fd-4432-9c15-175f1a89f296)
